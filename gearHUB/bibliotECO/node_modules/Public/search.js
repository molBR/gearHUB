$(window).on('load',function(){
  var jsonData;
  var inputoutput = '<input type="email" class="form-control input-lg" id="search" placeholder="Digite o que deseja para começar a procura">';
  console.log("oi");
  $.getJSON('data.json', function(data){
    jsonData = data;
    $('#carrega').html(inputoutput);
    output2 = "";
    output = "<table class='table'>";
    output += "<thead>";
    output += "<tr>";
    output += "<th>Titulo</th>";
    output += "<th>Autor</th>";
    output += "<th>Orientador</th>";
    output += "<th>Palavras-Chave</th>";
    output += "<th>Tipo</th>";
    output += "<th></th>";
    output += "</tr>";
    output += "</thead>";
    output += "<tbody>";
    $.each(jsonData, function(key, val){
      var searchField = $('#search').val();
      var regex = new RegExp(searchField, "i");
      output += '<tr>';
      output += '<td>';
      output += val.infoDoc.titulo;
      output += '</td>';
      output += '<td>';
      output += val.infoDoc.autores;
      output += '</td>';
      output += '<td>';
      output += val.infoDoc.orientador;
      output += '</td>';
      output += '<td>';
      output += val.infoDoc.palavrasChave;
      output += '<td>';
      output += val.infoDoc.tipo;
      output += '</td>';
      output += '<td>';
      output += "<form action='/upload/' enctype='application/json'>"
      output += "<input type='hidden' name='id' value="+val._id+">"
      output += "<button type='submit' class='btn btn-default' aria-label='Left Align' name='press' value='ver'>"
      output += "<span class='fa fa-eye' aria-hidden='true'></span>"
      output2 += "</button>"
      output2 += "<button type='submit' class= 'btn btn-default' aria-label='Left Align' name='press' value='editar'>"
      output2 += "<span class='fa fa-pencil' aria-hidden='true'></span>"
      output2 += "</button>"

      output += "</form>"
      output += "</td>"
      output += "</tr>";
      
    });
    output += "</tbody>";
    output += "</table>"
  $('#results').html(output);
  $('#userGranted').html(output2);
  });
  $('#carrega').keypress(function(){
      output2 = "";
      output = "<table class='table'>";
      output += "<thead>";
      output += "<tr>";
      output += "<th>Titulo</th>";
      output += "<th>Autor</th>";
      output += "<th>Orientador</th>";
      output += "<th>Palavras-Chave</th>";
      output += "<th>Tipo</th>";
      output += "<th></th>";
      output += "</tr>";
      output += "</thead>";
      output += "<tbody>";
    $.each(jsonData, function(key, val){
      var searchField = $('#search').val();
      var regex = new RegExp(searchField, "i");
      if ((val.infoDoc.titulo.search(regex) != -1) || 
          (val.infoDoc.autores.search(regex) != -1) ||
          (val.infoDoc.orientador.search(regex) != -1) || //pesquisa pequena né heheh
          (val.infoDoc.palavrasChave.search(regex) != -1) || 
          (val.infoDoc.tipo.search(regex) != -1))
      {
        output += '<tr>'
        output += '<td>';
        output += val.infoDoc.titulo;
        output += '</td>';
        output += '<td>';
        output += val.infoDoc.autores;
        output += '</td>';
        output += '<td>';
        output += val.infoDoc.orientador;
        output += '</td>';
        output += '<td>';
        output += val.infoDoc.palavrasChave;
        output += '<td>';
        output += val.infoDoc.tipo;
        output += '</td>';
        output += '<td>';
        output += "<form action='/upload/' enctype='application/json'>"
        output += "<input type='hidden' name='id' value="+val._id+">"
        output += "<button type='submit' class='btn btn-default' aria-label='Left Align' name='press' value='ver'>"
        output += "<span class='fa fa-eye' aria-hidden='true'></span>"
        output2 += "</button>"
        output2 += "<button type='submit' class= 'btn btn-default' aria-label='Left Align' name='press' value='editar'>"
        output2 += "<span class='fa fa-pencil' aria-hidden='true'></span>"
        output2 += "</button>"

        output += "</form>"
        output += "</td>"
        output += "</tr>";
      }
    if($('#search').val().length === 0)
      console.log("OI");
    });
    output += "</tbody>";
    output += "</table>"
  $('#results').html(output);
  $('#userGranted').html(output2);
  });



});